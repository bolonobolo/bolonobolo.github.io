---
layout: single
title: Msfvenom Exec Payload Analysis
date: 2019-10-10
classes: wide
header:
  teaser: /assets/images/SLAE32/shellcoding32.png
tags:
  - Assembly
  - Pentester Academy
  - SLAE32
  - Shellcode
  - Certifications
--- 
![](/assets/images/SLAE32/shellcoding32.png)

## Introduction
If we search on internet we will find a lot of ready to use shellcodes of various types, somes are for simple command execution, others adds "secret users" in victim machine, others are bind and reverse shell like the shellcodes wrote in this blog. The question is, shall we trust shellcodes found in internet? Following the general rule "Trust no one" the answer should be a big No, but sometime, for example when we have limited time, we prefer or we are forced to use others shellcode.<br>
In this cases what we suggest is to analyze the downloaed shellcode in sandbox machine before use it, to ensure that it will do what it declare.<br>
For this post we want to show how to analyze 3 samples of shellcodes took from msfvenom payload tool.
We can use the msfvenom tool to list payloads that could be produced:
```bash
root@slae32-lab:# msfvenom -l payloads |grep linux/x86
```
![](/assets/images/SLAE32/assignment_5/analysis_0.png)<br>
We have already build (and analyzed) the bind and reverse shellcode types so we choosed this 3 shellcode samples:
- [linux/x86/adduser](https://blackcloud.me/SLAE32-5-1/) "Create a new user with UID 0"
- [linux/x86/chmod](https://blackcloud.me/SLAE32-5-2/) "Runs chmod on specified file with specified mode"
- linux/x86/exec "Execute an arbitrary command"

So let's start our analysis

## Exec
First thing, we must create the payload with msfvenom
```bash
root@slae32-lab:# msfvenom -p linux/x86/exec CMD=id -f C -a x86 --platform linux
No encoder or badchars specified, outputting raw payload
Payload size: 38 bytes
Final size of c file: 185 bytes
unsigned char buf[] = 
"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f\x73\x68"
"\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x03\x00\x00\x00\x69"
"\x64\x00\x57\x53\x89\xe1\xcd\x80";

```
Now we need to analyze it with ndisasm, using the command 