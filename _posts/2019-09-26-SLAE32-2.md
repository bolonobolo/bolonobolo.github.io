---
layout: single
title: TCP Reverse Shell for Linux x86
date: 2019-9-19
classes: wide
header:
  teaser: /assets/images/OSCP/pwk.png
tags:
  - Assembly
  - Pentester Academy
  - SLAE32
  - Reverse Shell TCP
  - Certifications
--- 
![](/assets/images/SLAE32/shellcoding32.png)

## Introduction
How many time you used the msfvenom command to craft a reverse shell for your scopes?
In my case, many times but all i have to do is give to msfvenom the right inputs and voilà, it gives us the shellcode ready to use.
This article would inspect the shellcode process to craft a tcp reverse shell in depth, written to analyse what are the components needed to build a x86 Linux shellocode. 
This is also the second assignment from Viviek Ramchandran's SLAE32 course.<br>
The first part of the assignment request to create a Shell_Reverse_TCP shellcode with these properties:
- Reverse connects to configured IP and Port
- Execs Shell on sucessfull connection

The second part request to create a script to make port number easily configurable.<br>
According with [Infosec Institute](https://resources.infosecinstitute.com/icmp-reverse-shell/), reverse shell could be compared to the old backdoors placed by programmers to always have a preferential access to systems.
> *reverse shell is a type of shell in which the target machine opens up a communication port or a listener on the victim machine and waits for an incoming connection. The attacker then connects to the victim machine’s listener which then leads to code or command execution on the server.* <br>

The last video lesson of SLAE course analyzes a tcp reverse shell payload created with msfvenom so the creation process is well documented like the shell structure, so the effort for this assignment is to pickup informations about all the syscalls needed for the tcp reverse shell using the linux kernel unistd.h header and the ```man 2``` command.
We will use also the book 
[Unix Network Programming](https://www.amazon.com/UNIX-Network-Programming-Richard-Stevens/dp/0139498761)
, foundamental to learn the substructures required in some syscalls.
We start reviewing the case study in the course and reading the png created with sctest of libemu tool suite, with that informations we can extract the syscalls needed to build our reverse shellcode:

- socket
- bind
- listen
- accept
- dup2 (3 times)
- execve